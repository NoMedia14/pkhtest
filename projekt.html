<!DOCTYPE html>
<html lang="de">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PKR</title><link rel="stylesheet" href="css/app.css"></head>
<body>
<nav class="menubar">
 <div class="mi" tabindex="0"><span>Datei</span><div class="mdd"><a href="index.html">Projektübersicht</a><a onclick="projektSpeichern()">Projekt speichern <kbd>Strg+S</kbd></a><div class="msep"></div><a onclick="csvDlg('ma')">CSV importieren (Mitarbeiter)</a><a onclick="csvDlg('ist')">CSV importieren (IST-Daten)</a></div></div>
 <div class="mi" tabindex="0"><span>Einstellungen</span><div class="mdd"><a onclick="dlgProjSet()">Projekteinstellungen</a><div class="msep"></div><a onclick="dlgSV()">Sozialversicherungsbeiträge</a><a onclick="dlgTarife()">Tarife</a><a onclick="dlgDA()">Dienstarten verwalten</a><a onclick="dlgKST()">Kostenstellen verwalten</a><div class="msep"></div><a onclick="dlgET()">Entgelttabelle</a><a onclick="dlgSZG()">Jahressonderzahlung</a><a onclick="dlgTE()">Tariferhöhungen</a></div></div>
 <div class="mi" tabindex="0"><span>Berichtswesen</span><div class="mdd"><a onclick="acOpen()">Analysecenter</a></div></div>
 <div class="mi" tabindex="0" onclick="szOpen()"><span>Szenariovergleich</span></div>
 <div class="mr"><span id="nav-title" class="nt">PKR</span><span id="save-ind" class="si"></span></div>
</nav>
<div class="app-layout">
 <div class="lp">
  <div class="lpt">Mitarbeiter</div>
  <div class="sr"><label>Suche:</label><input type="text" id="ma-q" class="inp sm" oninput="filt()"><label>DA:</label><select id="f-da" class="inp sm" onchange="filt()"><option value="">Alle</option></select><label>KSt:</label><select id="f-kst" class="inp sm" onchange="filt()"><option value="">Alle</option></select></div>
  <div class="sr"><label>Gruppierung:</label><label class="rl"><input type="radio" name="grp" value="" checked onchange="setGrp('')"> Keine</label><label class="rl"><input type="radio" name="grp" value="da" onchange="setGrp('da')"> Dienstart</label><label class="rl"><input type="radio" name="grp" value="kst" onchange="setGrp('kst')"> Kostenstelle</label></div>
  <div class="sr"><button class="be" onclick="maAdd()">+ Neu</button><button class="be" onclick="maDel()">Entfernen</button><button class="be" onclick="maDup()">Duplizieren</button><button class="be" onclick="maAll()">Alle auswählen</button><button class="be bi" onclick="ladeProjekt()" title="Aktualisieren">&#x21bb;</button><button class="be bi" onclick="dlgSpalten()" title="Spalten">&#x2699;</button></div>
  <div class="mw"><table class="tt" id="tma"><thead id="mth"><tr></tr></thead><tbody id="mtb"></tbody></table></div>
  <div class="gl" id="gk">Gesamtkosten alle Mitarbeiter: 0,00 &euro;</div>
 </div>
 <div class="rp">
  <div class="tbar"><button class="tb active" onclick="swTab('stamm',this)">Stammdaten</button><button class="tb" onclick="swTab('plan',this)">Planung / Hochrechnung</button></div>
  <div class="tp active" id="tab-stamm">
   <div id="se" class="eh">Mitarbeiter auswählen oder neu anlegen</div>
   <div id="sf" style="display:none">
    <div class="sg"><fieldset><legend>Persönliche Daten</legend><div class="fr"><div class="fg"><label>Personalnummer:</label><input type="text" id="s-pnr" class="inp"></div><div class="fg"><label>Titel:</label><input type="text" id="s-titel" class="inp" style="width:70px"></div><div class="fg"><label>Nachname:</label><input type="text" id="s-nachname" class="inp"></div><div class="fg"><label>Vorname:</label><input type="text" id="s-vorname" class="inp"></div></div></fieldset>
    <fieldset><legend>Organisation</legend><div class="fr"><div class="fg"><label>Dienstart:</label><select id="s-da" class="inp"></select></div><div class="fg"><label>Kostenstelle:</label><select id="s-kst" class="inp"></select></div><div class="fg"><label>Vollkraft (VK):</label><input type="text" id="s-vk" class="inp" style="width:70px" oninput="updWstd()"></div><div class="fg"><label>Wochenstunden:</label><input type="text" id="s-wstd" class="inp" style="width:70px" readonly></div></div><div id="s-winfo" class="il">Tarifstunden: -</div></fieldset></div>
    <div class="sg"><fieldset><legend>Vergütung</legend><div class="fr"><div class="fg"><label>Tarif:</label><select id="s-tarif" class="inp" onchange="onTarif()"></select></div><div class="fg"><label>Entgeltgruppe:</label><select id="s-eg" class="inp" onchange="onEg()"></select></div><div class="fg"><label>Stufe:</label><select id="s-stufe" class="inp" onchange="onStufe()"></select></div><div class="fg"><label>Monatsbrutto (&euro;):</label><input type="text" id="s-brutto" class="inp" style="width:110px"></div></div><button class="be" onclick="bruttoET()" style="margin-top:4px">Aus Entgelttabelle laden</button></fieldset>
    <fieldset><legend>Ein-/Austritt</legend><div class="fr"><div class="fg"><label>Eintritt (TT.MM.JJJJ):</label><input type="text" id="s-ein" class="inp" style="width:120px"></div><div class="fg"><label>Austritt (TT.MM.JJJJ):</label><input type="text" id="s-aus" class="inp" style="width:120px"></div></div></fieldset></div>
    <fieldset><legend>Bemerkungen</legend><textarea id="s-bem" class="inp" rows="3" style="width:100%"></textarea></fieldset>
    <div class="sa"><button class="be ba" onclick="projektSpeichern()">Projekt speichern</button><button class="be ba" id="btn-ss" onclick="stammSave()">Stammdaten speichern</button></div>
   </div>
  </div>
  <div class="tp" id="tab-plan">
   <div id="pe" class="eh">Mitarbeiter auswählen</div>
   <div id="pc" style="display:none">
    <div class="st">Anpassungen</div>
    <div class="sr"><button class="be" onclick="dlgStufe()">Stufenaufstieg</button><button class="be" onclick="dlgErh()">Erhöhung</button><button class="be" onclick="dlgStd()">Stundenanpassung</button><button class="be" onclick="dlgAbw()">Abwesenheit</button><button class="be" onclick="dlgSzP()">Jahressonderzahlung</button><button class="be" onclick="anpDel()">Entfernen</button></div>
    <div class="aw"><table class="tt" id="tanp"><thead><tr><th>Typ</th><th>Details</th><th>Ab Monat</th><th>Bemerkung</th></tr></thead><tbody id="atb"></tbody></table></div>
    <div class="st" style="margin-top:6px">Jahreshochrechnung</div>
    <div class="sr hrc"><label class="cl"><input type="checkbox" id="cv" onchange="ergR()"> VK</label><label class="cl"><input type="checkbox" id="cs" onchange="ergR()"> Std</label><label class="cl"><input type="checkbox" id="ca" onchange="ergR()"> Anteil</label><label class="cl"><input type="checkbox" id="cb" checked onchange="ergR()"> Brutto</label><label class="cl"><input type="checkbox" id="csz" checked onchange="ergR()"> SZ</label><label class="cl"><input type="checkbox" id="cag" checked onchange="ergR()"> AG</label><label class="cl"><input type="checkbox" id="cg" checked onchange="ergR()"> Gesamt</label><button class="be" style="margin-left:auto;font-size:11px" onclick="rstIst()">Manuelle Änderungen zurücksetzen</button></div>
    <div class="ew"><table class="tt tn" id="terg"><thead id="eth"><tr></tr></thead><tbody id="etb"></tbody></table></div>
    <div class="es" id="esum"></div>
   </div>
  </div>
 </div>
</div>
<div id="dov" class="ov" style="display:none" onclick="if(event.target===this)DC()"></div>
<div id="dbox" class="db" style="display:none"><div class="dh"><span id="dtit"></span><button class="dx" onclick="DC()">&#x2715;</button></div><div id="dbod" class="dbd"></div></div>
<div id="aov" class="ov" style="display:none" onclick="if(event.target===this)acClose()"></div>
<div id="abox" class="ab" style="display:none"><div class="dh"><span>Analysecenter</span><button class="dx" onclick="acClose()">&#x2715;</button></div><div class="acl"><div class="acll"><div class="st">Mitarbeiterauswahl</div><div class="sr"><label>Suche:</label><input type="text" id="aq" class="inp sm" oninput="acFilt()"></div><div id="aml" class="acml"></div><div class="sr"><button class="be" onclick="acAll(1)">Alle</button><button class="be" onclick="acAll(0)">Keine</button><label>DA:</label><select id="afda" class="inp sm" onchange="acFDA()"><option value="">&#x2013;</option></select><label>KSt:</label><select id="afkst" class="inp sm" onchange="acFKST()"><option value="">&#x2013;</option></select></div><div class="st">Berichte</div><div class="acb"><label class="rl"><input type="radio" name="atyp" value="verlauf" checked> Jahresverlauf</label><label class="rl"><input type="radio" name="atyp" value="da"> Nach Dienstart</label><label class="rl"><input type="radio" name="atyp" value="kst"> Nach Kostenstelle</label><label class="rl"><input type="radio" name="atyp" value="ma"> Mitarbeitervergleich</label><label class="rl"><input type="radio" name="atyp" value="uebersicht"> Gesamtübersicht</label><label class="rl"><input type="radio" name="atyp" value="detail"> Detail pro Mitarbeiter</label></div><button class="be ba" style="margin-top:8px;width:100%" onclick="acRun()">Vorschau aktualisieren</button></div><div class="aclr" id="apv"><div class="eh">Bericht auswählen und "Vorschau aktualisieren" klicken</div></div></div></div>
<div id="sov" class="ov" style="display:none" onclick="if(event.target===this)szClose()"></div>
<div id="sbox" class="ab" style="display:none"><div class="dh"><span>Szenariovergleich</span><button class="dx" onclick="szClose()">&#x2715;</button></div><div id="sbod" style="padding:12px;overflow:auto;flex:1"></div></div>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/config.js"></script><script src="js/calc.js"></script><script src="js/db.js"></script><script src="js/app.js"></script>
<script>var pid=new URLSearchParams(location.search).get('id');if(pid){initDB(SUPABASE_URL,SUPABASE_KEY);initProjekt(pid)}else location.href='index.html';document.addEventListener('keydown',function(e){if(e.ctrlKey&&e.key==='s'){e.preventDefault();projektSpeichern()}})</script>
</body></html>